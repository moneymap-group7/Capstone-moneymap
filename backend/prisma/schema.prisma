generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  userId       BigInt        @id @default(autoincrement())
  fullName     String        @db.VarChar(100)
  email        String        @unique @db.VarChar(254)
  passwordHash String
  isActive     Boolean       @default(true)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  lastLoginAt  DateTime?
  transactions Transaction[]

  @@map("users")
}

enum TransactionType {
  DEBIT
  CREDIT
}

enum TransactionSource {
  CSV
  PDF
  MANUAL
}

model Transaction {
  transactionId BigInt @id @default(autoincrement())
  userId        BigInt

  transactionDate DateTime
  postedDate      DateTime?

  description String @db.VarChar(255)

  amount   Decimal @db.Decimal(12, 2)
  currency String  @default("CAD") @db.Char(3)

  transactionType TransactionType
  source          TransactionSource

  balanceAfter Decimal? @db.Decimal(12, 2)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  user User @relation(fields: [userId], references: [userId])

  @@index([userId])
  @@index([transactionDate])
  @@map("transactions")
}
